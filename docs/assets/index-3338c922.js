var R=Object.defineProperty;var M=(r,t,e)=>t in r?R(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var u=(r,t,e)=>(M(r,typeof t!="symbol"?t+"":t,e),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&o(a)}).observe(document,{childList:!0,subtree:!0});function e(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(i){if(i.ep)return;i.ep=!0;const s=e(i);fetch(i.href,s)}})();const m={up:["ArrowUp","w"],down:["ArrowDown","s"],left:["ArrowLeft","a"],right:["ArrowRight","d"],toggleDebugGameState:["O"],debugPlayerSpriteSheet:["P"]},C=r=>t=>{m.up.includes(t.key)&&(t.preventDefault(),r.controls.up=!0),m.down.includes(t.key)&&(t.preventDefault(),r.controls.down=!0),m.left.includes(t.key)&&(t.preventDefault(),r.controls.left=!0),m.right.includes(t.key)&&(t.preventDefault(),r.controls.right=!0),m.toggleDebugGameState.includes(t.key)&&(t.preventDefault(),r.settings.debugGameState=!r.settings.debugGameState,r.elements.gameStateContainer.style.display=r.settings.debugGameState?"block":"none"),m.debugPlayerSpriteSheet.includes(t.key)&&(t.preventDefault(),r.settings.debugPlayerSpriteSheet=!r.settings.debugPlayerSpriteSheet)},T=r=>t=>{m.up.includes(t.key)&&(t.preventDefault(),r.controls.up=!1),m.down.includes(t.key)&&(t.preventDefault(),r.controls.down=!1),m.left.includes(t.key)&&(t.preventDefault(),r.controls.left=!1),m.right.includes(t.key)&&(t.preventDefault(),r.controls.right=!1)};const E=(r,t)=>{const e=new Image;return e.onload=r,e.src=t,e},X=r=>r.split(" ").reduce((o,i)=>{const[s,a]=i.split("=");return["true","false"].includes(a)?o[s]=a==="true":o[s]=a,o},{}),A=r=>Object.entries(r.frames).reduce((t,[e,o],i)=>{var f;const[s,a]=e.split("--");if(t[s])t[s].frames.push(o);else{const n=((f=r.meta.frameTags.find(({name:l})=>s===l))==null?void 0:f.data)||"",d=X(n);t[s]={frames:[o],data:d}}return t},{});class U{constructor(t,e,o,i){u(this,"spriteSheet");u(this,"spriteFrames");this.spriteJSON=t,this.emitter=o,this.onLoad=i,this.spriteSheet=E(()=>{var s;(s=this.onLoad)==null||s.call(this),this.emitter.emit("imageLoaded",{imagePath:e})},e),this.spriteJSON=t,this.spriteFrames=A(this.spriteJSON)}}const H={"Blink Bounce Down--0":{frame:{x:0,y:0,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Blink Bounce Down--1":{frame:{x:16,y:0,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Blink Bounce Down--2":{frame:{x:32,y:0,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Blink Bounce Down--3":{frame:{x:48,y:0,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Blink Bounce Down--4":{frame:{x:64,y:0,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Bounce Down--0":{frame:{x:0,y:16,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Bounce Down--1":{frame:{x:16,y:16,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Bounce Down--2":{frame:{x:32,y:16,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Bounce Down--3":{frame:{x:48,y:16,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Bounce Right--0":{frame:{x:0,y:32,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Bounce Right--1":{frame:{x:16,y:32,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Bounce Right--2":{frame:{x:32,y:32,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Bounce Right--3":{frame:{x:48,y:32,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Blink Bounce Right--0":{frame:{x:0,y:48,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Blink Bounce Right--1":{frame:{x:16,y:48,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Blink Bounce Right--2":{frame:{x:32,y:48,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Blink Bounce Right--3":{frame:{x:48,y:48,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Blink Bounce Right--4":{frame:{x:64,y:48,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Bounce Left--0":{frame:{x:0,y:64,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Bounce Left--1":{frame:{x:16,y:64,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Bounce Left--2":{frame:{x:32,y:64,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Bounce Left--3":{frame:{x:48,y:64,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Bounce Left--4":{frame:{x:64,y:64,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Blink Bounce Left--0":{frame:{x:0,y:80,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Blink Bounce Left--1":{frame:{x:16,y:80,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Blink Bounce Left--2":{frame:{x:32,y:80,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Blink Bounce Left--3":{frame:{x:48,y:80,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Blink Bounce Left--4":{frame:{x:64,y:80,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Bounce Up--0":{frame:{x:0,y:96,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Bounce Up--1":{frame:{x:16,y:96,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Bounce Up--2":{frame:{x:32,y:96,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Bounce Up--3":{frame:{x:48,y:96,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Hair Move up--0":{frame:{x:0,y:112,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Hair Move up--1":{frame:{x:16,y:112,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Hair Move up--2":{frame:{x:32,y:112,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Hair Move up--3":{frame:{x:48,y:112,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Walk Down--0":{frame:{x:0,y:128,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Walk Down--1":{frame:{x:16,y:128,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Walk Down--2":{frame:{x:32,y:128,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Walk Down--3":{frame:{x:48,y:128,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Walk Down--4":{frame:{x:64,y:128,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Walk Right--0":{frame:{x:0,y:144,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Walk Right--1":{frame:{x:16,y:144,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Walk Right--2":{frame:{x:32,y:144,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Walk Right--3":{frame:{x:48,y:144,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Walk Right--4":{frame:{x:64,y:144,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Walk Right--5":{frame:{x:80,y:144,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Walk Right--6":{frame:{x:96,y:144,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Walk Right--7":{frame:{x:112,y:144,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Walk Left--0":{frame:{x:0,y:160,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Walk Left--1":{frame:{x:16,y:160,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Walk Left--2":{frame:{x:32,y:160,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Walk Left--3":{frame:{x:48,y:160,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Walk Left--4":{frame:{x:64,y:160,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Walk Left--5":{frame:{x:80,y:160,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Walk Left--6":{frame:{x:96,y:160,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Walk Left--7":{frame:{x:112,y:160,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Walk Left--8":{frame:{x:128,y:160,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Walk Up--0":{frame:{x:0,y:176,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Walk Up--1":{frame:{x:16,y:176,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Walk Up--2":{frame:{x:32,y:176,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Walk Up--3":{frame:{x:48,y:176,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Walk Up--4":{frame:{x:64,y:176,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100},"Walk Up--5":{frame:{x:80,y:176,w:16,h:16},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:16,h:16},sourceSize:{w:16,h:16},duration:100}},O={app:"https://www.aseprite.org/",version:"1.3-rc6-x64",image:"player.png",format:"RGBA8888",size:{w:144,h:192},scale:"1",frameTags:[{name:"Blink Bounce Down",from:0,to:4,direction:"forward",color:"#000000ff",data:"direction=down movement=false blink=true"},{name:"Bounce Down",from:5,to:8,direction:"forward",color:"#000000ff",data:"direction=down movement=false blink=false"},{name:"Bounce Right",from:9,to:12,direction:"forward",color:"#000000ff",data:"direction=right movement=false blink=false"},{name:"Blink Bounce Right",from:13,to:17,direction:"forward",color:"#000000ff",data:"direction=right movement=false blink=true"},{name:"Bounce Left",from:18,to:22,direction:"forward",color:"#000000ff",data:"direction=left movement=false blink=false"},{name:"Blink Bounce Left",from:23,to:27,direction:"forward",color:"#000000ff",data:"direction=left movement=false blink=true"},{name:"Bounce Up",from:28,to:31,direction:"forward",color:"#000000ff",data:"direction=up movement=false blink=false"},{name:"Hair Move up",from:32,to:35,direction:"forward",color:"#000000ff",data:"direction=up movement=false blink=true"},{name:"Walk Down",from:36,to:40,direction:"forward",color:"#000000ff",data:"direction=down movement=true blink=false"},{name:"Walk Right",from:41,to:48,direction:"forward",color:"#000000ff",data:"direction=right movement=true blink=false"},{name:"Walk Left",from:49,to:57,direction:"forward",color:"#000000ff",data:"direction=left movement=true blink=false"},{name:"Walk Up",from:58,to:63,direction:"forward",color:"#000000ff",data:"direction=up movement=true blink=false"}]},N={frames:H,meta:O};let P=0;class I{constructor(t,e,o){u(this,"id",P++);u(this,"sprite");this.state=t,this.name=e,this.emitter=o}update(t,e){}}class G extends I{constructor(t,e,o,i,s){super(t,e,o),this.state=t,this.name=e,this.emitter=o,this.sprite=new U(i,s,o)}}const z=class z extends G{constructor(e,o){super(e,z.NAME,o,N,"./player.png");u(this,"update",(e,o)=>{let i=!1,s=this.state.yDir,a=this.state.xDir,f=!1,n=!1;if(e.controls.up&&(s=-1,i=!0,n=!0),e.controls.down&&(s=1,i=!0,n=!0),e.controls.left&&(a=-1,i=!0,f=!0),e.controls.right&&(a=1,i=!0,f=!0),i){const d=Math.atan2(s,a);this.state.x+=Math.cos(d)*this.state.speedX*e.time.delta,this.state.y+=Math.sin(d)*this.state.speedY*e.time.delta}this.state.moving=i,f&&!n?s=0:n&&!f&&(a=0),this.state.yDir=s,this.state.xDir=a});this.state=e}};u(z,"NAME","player");let y=z;const Y=(r,t,e)=>{r.beginPath(),r.fillStyle=e,r.rect(0,0,t.width,t.height),r.fill(),r.closePath()},q=(r,t,e,o)=>{const i=t.width,s=t.height,a=i/50;for(let n=0;n<=i;n+=a)r.moveTo(.5+n+e,e),r.lineTo(.5+n+e,s+e);for(var f=0;f<=s;f+=a)r.moveTo(e,.5+f+e),r.lineTo(i+e,.5+f+e);r.strokeStyle=o,r.stroke()},W=(r,t,e,{canvasX:o,canvasY:i,canvasWidth:s,canvasHeight:a,spriteX:f,spriteY:n,spriteWidth:d,spriteHeight:l})=>{r.imageSmoothingEnabled=!1,r.drawImage(e,f,n,d,l,o,i,s,a)},_=(r,t,e)=>{var f;if(!e.sprite)throw new Error("No sprite on entity");const o=e.state;let i;i=Object.entries((f=e.sprite)==null?void 0:f.spriteFrames).filter(([n,d])=>d.data.movement===o.moving&&d.data.direction===t);const[s,a]=i.find(([n,d])=>{var w;if(!n)throw new Error("Failed to load sprite sheet");let l=null;if(o.currentAnimationName===n&&o.animationToEnd&&o.animationFrameX===0&&(o.lastAnimationName=n,r.emitter.emit("player.animationEnd",{name:n}),o.animationToEnd=!1,l=!1),o.lastAnimationName===n&&i.length>1&&(l=!1),o.animationFrameX>=d.frames.length-1&&(o.animationToEnd=!0),l!==!1&&(l=!0),l){const S=r.time.lastFrameTimeMs-o.animationFrameXStart;o.animationFrameX>=d.frames.length&&(o.animationFrameX=0),S>((w=d.frames[o.animationFrameX])==null?void 0:w.duration)&&(o.animationFrameXStart=r.time.lastFrameTimeMs,o.animationFrameX++,o.animationFrameX>=d.frames.length&&(o.animationFrameX=0))}return l})||i[0];if(s==="")throw new Error("Sprite frame name not found");if(!a)throw new Error("Sprite frame value not found");return o.currentAnimationName=s,a.frames[o.animationFrameX]},J=(r,t,e,o)=>{if(!r.sprite)return;const i=r.state,s=i.yDir<0,a=i.yDir>0,f=i.xDir>0,n=i.xDir<0,l=_(o,s?"up":a?"down":f?"right":n?"left":"down",r),w=l.spriteSourceSize.w,S=l.spriteSourceSize.h,B=l.frame.x,D=l.frame.y,F=i.x,b=i.y,L={canvasX:F,canvasY:b,canvasWidth:e.width/50*4,canvasHeight:e.width/50*4,spriteX:B,spriteY:D,spriteWidth:w,spriteHeight:S};o.emitter.emit("renderSprite",{spriteData:L,entity:r});const h=r.sprite.spriteSheet;if(W(t,e,h,L),o.settings.debugPlayerSpriteSheet&&r.name===y.NAME){W(t,e,h,{canvasX:250,canvasY:250,canvasWidth:h.naturalWidth*4,canvasHeight:h.naturalHeight*4,spriteX:0,spriteY:0,spriteWidth:h.naturalWidth,spriteHeight:h.naturalHeight}),t.beginPath(),t.strokeStyle="teal";const v=t.lineWidth;t.lineWidth=5,t.rect(250+B*4,250+D*4,w*4,S*4),t.stroke(),t.lineWidth=v,t.closePath()}},K=(r,t,e)=>{e.emitter.emit("renderStart"),Y(r,t,"#fff"),q(r,t,0,"#000");const o=e.entities,i=o.length;for(let s=0;s<i;s++)J(o[s],r,t,e);e.settings.debugGameState&&e.elements.gameStateContainer&&(e.elements.gameStateContainer.innerHTML=JSON.stringify({controls:e.controls,emitter:e.emitter,entities:e.entities.map(s=>({id:s.id,name:s.name,state:s.state})),settings:e.settings,time:e.time,world:e.world},null,2)),e.emitter.emit("renderEnd")},j=(r,t)=>{const e=r.entities,o=e.length;for(let i=0;i<o;i++)e[i].update(r,t)},Q=r=>{r.time.resetDeltaCount++,r.time.delta=0},V=(r,t,e)=>{if(!r)throw new Error("Missing canvas context");const o=i=>{if(i<e.time.lastFrameTimeMs+1e3/e.time.maxFPS){e.time.stepID=window.requestAnimationFrame(o);return}e.time.delta+=i-e.time.lastFrameTimeMs,e.time.lastFrameTimeMs=i,i>e.time.lastFpsUpdate+1e3&&(e.time.fps=.25*e.time.framesThisSecond+.75*e.time.fps,e.time.lastFpsUpdate=i,e.time.framesThisSecond=0,e.emitter.emit("fps",{fps:e.time.fps})),e.time.framesThisSecond++;let s=0;for(;e.time.delta>=e.time.timeStep;)if(j(e,i),e.time.delta-=e.time.timeStep,++s>=240){Q(e);break}e.time.frameID++,K(r,t,e),e.time.stepID=window.requestAnimationFrame(o)};o(1)},p=class p{constructor(){u(this,"listeners",{[p.ALL]:[]})}on(t,e){this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push(e)}emit(t,e){const o=this.listeners[t];if(o){const s=o.length;for(let a=0;a<s;a++)o[a](t,e)}const i=this.listeners[p.ALL];if(i){const s=i.length;for(let a=0;a<s;a++)i[a](t,e)}}off(t,e){const o=this.listeners[t];o&&(this.listeners[t]=o.filter(i=>i!==e))}};u(p,"ALL","all");let x=p,k,g,c;const Z=()=>{const r=new x,t=document.querySelector("#main-game-canvas");if(!t)throw new Error("Main canvas not found");t.width=window.innerWidth,t.height=window.innerHeight;const e=t==null?void 0:t.getContext("2d");if(!e)throw new Error("Main canvas context not found");r.emit("init",{mainCanvas:t,mainCanvasContext:e});const o=document.querySelector("#game-state");if(!o)throw new Error("Game State Container not found");r.on("fps",(s,a)=>console.log(a));const i={entities:[new y({x:0,y:0,xDir:0,yDir:0,speedX:.25,speedY:.25,moving:!1,spriteSize:16,currentAnimationName:"",lastAnimationName:"",animationToEnd:!1,animationFrameX:0,animationFrameXStart:0},r)],controls:{up:!1,down:!1,left:!1,right:!1},world:{running:!1,started:!1},settings:{debugGameState:!1,debugPlayerSpriteSheet:!1},time:{delta:0,fps:60,framesThisSecond:0,lastFpsUpdate:0,lastFrameTimeMs:0,maxFPS:60,timeStep:1e3/60,stepID:0,frameID:0,resetDeltaCount:0},elements:{mainCanvas:t,mainCanvasContext:e,gameStateContainer:o},emitter:r};return e==null||e.rect(0,0,t.width,t.height),e==null||e.fill(),{mainCanvas:t,mainCanvasContext:e,gameState:i}};try{const r=Z();k=r.mainCanvas,g=r.mainCanvasContext,c=r.gameState}catch(r){console.error("Failed to initialize"+r)}document.addEventListener("keydown",r=>{C(c)(r)});document.addEventListener("keyup",r=>{T(c)(r)});window.addEventListener("resize",()=>{c.elements.mainCanvas.width=window.innerWidth,c.elements.mainCanvas.height=window.innerHeight});const $=()=>{g&&k&&c&&(c.world.started=!0,c.world.running=!0,V(g,k,c))};$();
